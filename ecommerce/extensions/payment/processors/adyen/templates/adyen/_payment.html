{% load adyen %}
{% load core_extras %}
{% load i18n %}
{% load staticfiles %}

{% get_alternative_payment_methods payment_processors.adyen basket as alternative_payment_methods %}

<div id="adyen-payment">
    <label class="group-label">{% trans "Select a Payment Method" %}</label>
    <div class="btn-group payment-method-btns" role="group">
        <a href="#card-payment" class="btn btn-default" aria-label="Credit Card"><div class="separator"><img src="{% static 'adyen/images/cards.png' %}"/></div></a>
        {% if payment_processors.paypal %}
        <a href="#paypal-payment" class="btn btn-default" aria-label="Paypal"><div class="separator"><img src="{% static 'adyen/images/paypal.png' %}"/></div></a>
        {% endif %}
        {% if alternative_payment_methods %}
        <a href="#alternative-payment" class="btn btn-default" aria-label="Alternative Payment Methods"><span class="content-block" aria-hidden="true">...</span></a>
        {% endif %}
    </div>

    <form method="POST" action="{% url 'adyen_payment' %}" id="card-payment-view" class="payment-view">
        <input type="hidden" value="{{ payment_processors.adyen.generation_time }}" id="generationtime" data-encrypted-name="generationtime" />

        <div class="form-group">
            <label class="group-label">{% trans "Billing Information" %}</label>
            <div class="form-inline row">
                <div class="form-group col-sm-6">
                    <label for="first_name" class="control-label">{% trans "First Name" %}*</label>
                    <input type="text" class="form-control" id="first_name" name="first_name" required data-error="{% trans 'Please enter your first name' %}"/>
                    <div class="help-block with-errors"></div>
                </div>
                <div class="form-group col-sm-6">
                    <label for="last_name" class="control-label">{% trans "Last Name" %}*</label>
                    <input type="text" class="form-control" id="last_name" name="last_name" required data-error="{% trans 'Please enter your last name' %}"/>
                    <div class="help-block with-errors"></div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="email" class="control-label">{% trans "Email" %}*</label>
            <input type="email" class="form-control" id="email" name="email" required data-error="Please enter a valid email address"/>
            <div class="help-block with-errors"></div>
        </div>
        <div class="form-group">
            <div class="form-inline row">
                <div class="form-group col-sm-6">
                    <label for="street_address" class="control-label">{% trans "Street Address" %}*</label>
                    <input type="text" class="form-control" id="street_address" name="street_address" required data-error="{% trans 'Please enter your street address' %}"/>
                    <div class="help-block with-errors"></div>
                </div>
                 <div class="form-group col-sm-6">
                    <label for="apartment_number" class="control-label">{% trans "Suite/Apartment Number" %}*</label>
                    <input type="text" class="form-control" id="apartment_number" name="apartment_number"/>
                    <div class="help-block with-errors"></div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="form-inline row">
                <div class="form-group col-sm-6">
                    <label for="city" class="control-label">{% trans "City" %}*</label>
                    <input type="text" class="form-control" id="city" name="city" required data-error="{% trans 'Please enter your city' %}"/>
                    <div class="help-block with-errors"></div>
                </div>
                <div class="form-group col-sm-6">
                    <label for="state" class="control-label">{% trans "State/Province" %}*</label>
                    <input type="text" class="form-control" id="state" name="state" required data-error="Please enter your state/province"/>
                    <div class="help-block with-errors"></div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="form-inline row">
                <div class="form-group col-sm-6">
                    <label for="country" class="control-label">{% trans "Country" %}*</label>
                    <select class="form-control" id="country" name="country" required data-error="{% trans 'Please enter your country' %}">
                        <option value="">{% trans "Please select a country..." %}</option>
                        {% get_countries as countries %}
                        {% for code, name in countries %}
                        <option value="{{ code }}">{{ name }}</option>
                        {% endfor %}
                    </select>
                    <div class="help-block with-errors"></div>
                </div>
                <div class="form-group col-sm-6">
                    <label for="postal_code" class="control-label">{% trans "Zip/Postal Code" %}*</label>
                    <input type="text" class="form-control" id="postal_code" name="postal_code" required data-error="{% trans 'Please enter your zip/postal code' %}"/>
                    <div class="help-block with-errors"></div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label class="group-label">{% trans "Payment Details" %}</label>
            <div class="form-group">
                <label for="holder_name" class="control-label">{% trans "Card Holder Name" %}*</label>
                <input type="text" class="form-control" id="holder_name" required data-error="{% trans 'Please enter the name on your card' %}" data-encrypted-name="holderName"/>
                <div class="help-block with-errors"></div>
            </div>
            <div class="form-inline row">
                <div class="form-group col-sm-6">
                    <label for="card_number" class="control-label">{% trans "Card Number" %}*</label>
                    <span class="decorated-field">
                        <input type="tel" pattern="[0-9]*" class="form-control" id="card_number" required data-error="{% trans 'Please enter a valid card number' %}" data-encrypted-name="number"/>
                        <img src="{% static 'adyen/images/lock.png' %}"/>
                    </span>
                    <div class="help-block with-errors"></div>
                </div>
                <div class="form-group col-sm-6">
                    <label for="card_cvc" class="control-label">
                        {% trans "Security Code" %}*
                        <i class="fa fa-question-circle" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="The security code is the last three numbers on the back of your card (4 numbers on the front if Amex)"></i>
                    </label>
                    <span class="decorated-field">
                        <input type="tel" pattern="[0-9]*" class="form-control" id="card_cvc" required data-error="{% trans 'Please enter a valid security code' %}" data-encrypted-name="cvc"/>
                        <img src="{% static 'adyen/images/lock.png' %}"/>
                    </span>
                    <div class="help-block with-errors"></div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="form-inline row">
                <div class="form-group col-sm-6">
                    <label for="card_expiry_month" class="control-label">{% trans "Expiration Date" %}*</label>
                    <select class="form-control" id="card_expiry_month" required data-error="{% trans 'Please enter the expiration month' %}" data-encrypted-name="expiryMonth">
                        <option value="">{% trans "Please select a month..." %}</option>
                        <option value="01">{% trans "January" %}</option>
                        <option value="02">{% trans "February" %}</option>
                        <option value="03">{% trans "March" %}</option>
                        <option value="04">{% trans "April" %}</option>
                        <option value="05">{% trans "May" %}</option>
                        <option value="06">{% trans "June" %}</option>
                        <option value="07">{% trans "July" %}</option>
                        <option value="08">{% trans "August" %}</option>
                        <option value="09">{% trans "September" %}</option>
                        <option value="10">{% trans "October" %}</option>
                        <option value="11">{% trans "November" %}</option>
                        <option value="12">{% trans "December" %}</option>
                    </select>
                    <div class="help-block with-errors"></div>
                </div>
                <div class="form-group col-sm-6">
                    <label for="card_expiry_year" class="control-label">&nbsp;</label>
                    <select class="form-control" id="card_expiry_year" required data-error="{% trans 'Please enter the expiration year' %}" data-encrypted-name="expiryYear">
                        <option value="">{% trans 'Please select a year...' %}</option>
                        <option value="2016">2016</option>
                        <option value="2017">2017</option>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                        <option value="2022">2022</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                        <option value="2026">2026</option>
                        <option value="2027">2027</option>
                        <option value="2028">2028</option>
                        <option value="2029">2029</option>
                        <option value="2030">2030</option>
                        <option value="2031">2031</option>
                        <option value="2032">2032</option>
                        <option value="2033">2033</option>
                        <option value="2034">2034</option>
                        <option value="2035">2035</option>
                        <option value="2036">2036</option>
                        <option value="2037">2050</option>
                    </select>
                    <div class="help-block with-errors"></div>
                </div>
            </div>
        </div>
        <div class="payment-form-btns">
            <div class="row">
                <div class="col-sm-6">
                    <div class="btn btn-lg btn-transparent btn-block">
                        <a href="{{ cancel_page_url }}" class="btn-cancel">{% trans "Cancel" %}</a>
                    </div>
                </div>
                <div class="col-sm-6">
                    <button data-track-type="click"
                            data-track-event="edx.bi.ecommerce.basket.payment_selected"
                            data-track-category="checkout"
                            data-processor-name="{{ payment_processors.adyen.NAME }}"
                            data-course-id="{{ course.id }}"
                            class="btn btn-lg btn-primary btn-block"
                            disabled="disabled"
                            value="{{ payment_processors.adyen.NAME }}"
                            id="{{ payment_processors.adyen.NAME }}"
                            type="submit"
                            form="card-payment-view">{% trans "Pay" %}</button>
                </div>
            </div>
        </div>
    </form>

    {% if payment_processors.paypal %}
    <div id="paypal-payment-view" class="payment-view payment-buttons" data-basket-id="{{ basket.id }}">
        <div class="row">
            <div class="col-sm-12">
                <button data-track-type="click"
                        data-track-event="edx.bi.ecommerce.basket.payment_selected"
                        data-track-category="checkout"
                        data-processor-name="{{ payment_processors.paypal.NAME }}"
                        data-course-id="{{ course.id }}"
                        class="btn btn-lg btn-primary btn-block payment-button"
                        value="{{ payment_processors.paypal.NAME }}"
                        id="{{ payment_processors.paypal.NAME }}">
                    {{ payment_processors.paypal.CHECKOUT_BUTTON_LABEL }}
                </button>
            </div>
        </div>
    </div>
    {% endif %}

    {% if alternative_payment_methods %}
    <div id="alternative-payment-view" class="payment-view">

    </div>
    {% endif %}
</div>
